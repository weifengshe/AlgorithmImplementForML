# graph the reinforcement learning for hard grid world
library(ggplot2)
library(reshape)

Iterations <- seq(1, 100)
## graph the steps
#ValueIteration <- c(3686,428,41,45,31,36,34,27,31,25,31,39,38,21,26,33,25,23,24,24,25,27,23,28,29,25,27,28,32,27,23,30,25,28,28,24,36,26,23,31,32,29,32,28,29,31,27,28,25,29,26,30,26,29,27,22,23,29,23,23,26,26,27,26,32,29,23,23,28,28,25,26,28,26,28,23,26,25,25,36,31,23,21,26,34,35,24,25,22,26,21,21,26,26,26,26,27,36,23,25)
#PolicyIteration <- c(3873,2839,5712,368,124,169,92,27,36,28,24,21,27,27,27,30,36,30,28,34,23,26,24,32,25,25,25,25,23,27,27,33,32,32,23,22,35,34,31,27,24,31,21,28,35,29,24,30,23,31,25,39,25,27,21,24,23,29,30,24,25,30,21,26,26,27,27,37,26,37,21,34,24,22,24,31,27,23,27,23,21,25,23,29,24,21,26,25,23,27,25,24,34,28,28,25,21,29,32,28)
QLearning <- c(478,560,504,450,416,464,63,37,65,141,210,208,460,340,221,213,61,44,146,59,92,46,224,49,325,332,63,50,65,81,101,28,68,40,57,56,98,179,96,152,37,37,27,36,172,86,40,122,106,116,33,29,79,39,129,65,33,77,107,68,330,26,42,45,58,33,58,58,43,29,101,45,67,39,74,125,42,48,45,55,42,56,127,65,149,52,29,70,62,39,129,80,42,47,78,65,58,49,72,35)


steps <- cbind(Iterations, QLearning) 
steps <- as.matrix(steps)

rownames(steps) <- steps[,'Iterations']
steps <- subset(steps, select = -c(Iterations))
steps <- melt(steps, id.vars = 'Iterations', variable.names = 'algo')
colnames(steps) <- c('Iterations', 'algo', 'steps')

head(steps)
tail(steps)

ggplot(steps, aes(Iterations, steps)) + 
        geom_line(aes(colour = algo)) + 
        ggtitle("Steps for hard grid world") #+ ylim(0, 500)

# graph the times
#ValueIteration <- c(215,12,18,18,23,21,22,49,39,42,35,33,38,31,36,39,81,149,114,35,40,51,57,69,52,59,77,134,146,55,50,51,64,60,62,58,68,64,156,139,171,72,79,64,83,76,72,80,86,88,111,104,101,88,116,92,96,103,97,106,97,107,105,109,105,108,98,110,91,119,98,102,114,115,126,108,134,113,124,124,115,135,139,140,176,127,141,142,137,133,141,129,136,136,148,143,134,145,275,201)
#PolicyIteration <- c(13,15,12,20,24,25,19,40,38,43,44,37,42,49,45,45,48,51,64,53,66,79,70,69,62,74,73,88,100,75,88,91,86,107,103,105,122,105,132,123,101,114,119,113,118,124,137,125,120,137,149,137,161,142,168,159,165,158,164,176,166,156,182,204,173,193,166,164,193,229,205,188,213,201,393,250,240,210,219,229,228,227,283,230,234,238,246,273,260,257,252,275,280,267,275,250,274,278,264,294)
QLearning <- c(182,49,37,90,43,43,40,97,46,58,39,68,104,47,45,53,50,39,57,132,121,46,51,50,46,32,29,32,39,103,101,70,31,38,52,45,50,89,38,42,54,54,52,50,34,56,47,99,50,65,44,34,32,45,51,43,61,47,71,43,60,53,59,52,59,55,43,51,54,54,41,56,40,46,68,49,47,57,52,50,64,83,110,74,65,104,76,64,59,75,80,83,66,45,76,97,102,59,65,55)

times <- cbind(Iterations, QLearning)
times <- as.matrix(times)

rownames(times) <- times[,'Iterations']
times <- subset(times, select = -c(Iterations))
times <- melt(times, id.vars = 'Iterations', variable.names = 'algo')
colnames(times) <- c('Iterations', 'algo', 'miniseconds')

head(times)
tail(times)

ggplot(times, aes(Iterations, miniseconds)) + 
        geom_line(aes(colour = algo)) + 
        ggtitle("Miniseconds required for hard grid world")





# graph the rewards
#ValueIteration <- c(-3584.0,-326.0,61.0,57.0,71.0,66.0,68.0,75.0,71.0,77.0,71.0,63.0,64.0,81.0,76.0,69.0,77.0,79.0,78.0,78.0,77.0,75.0,79.0,74.0,73.0,77.0,75.0,74.0,70.0,75.0,79.0,72.0,77.0,74.0,74.0,78.0,66.0,76.0,79.0,71.0,70.0,73.0,70.0,74.0,73.0,71.0,75.0,74.0,77.0,73.0,76.0,72.0,76.0,73.0,75.0,80.0,79.0,73.0,79.0,79.0,76.0,76.0,75.0,76.0,70.0,73.0,79.0,79.0,74.0,74.0,77.0,76.0,74.0,76.0,74.0,79.0,76.0,77.0,77.0,66.0,71.0,79.0,81.0,76.0,68.0,67.0,78.0,77.0,80.0,76.0,81.0,81.0,76.0,76.0,76.0,76.0,75.0,66.0,79.0,77.0)
#PolicyIteration <- c(-3771.0,-2737.0,-5610.0,-266.0,-22.0,-67.0,10.0,75.0,66.0,74.0,78.0,81.0,75.0,75.0,75.0,72.0,66.0,72.0,74.0,68.0,79.0,76.0,78.0,70.0,77.0,77.0,77.0,77.0,79.0,75.0,75.0,69.0,70.0,70.0,79.0,80.0,67.0,68.0,71.0,75.0,78.0,71.0,81.0,74.0,67.0,73.0,78.0,72.0,79.0,71.0,77.0,63.0,77.0,75.0,81.0,78.0,79.0,73.0,72.0,78.0,77.0,72.0,81.0,76.0,76.0,75.0,75.0,65.0,76.0,65.0,81.0,68.0,78.0,80.0,78.0,71.0,75.0,79.0,75.0,79.0,81.0,77.0,79.0,73.0,78.0,81.0,76.0,77.0,79.0,75.0,77.0,78.0,68.0,74.0,74.0,77.0,81.0,73.0,70.0,74.0)
QLearning <- c(-376.0,-458.0,-402.0,-348.0,-314.0,-362.0,39.0,65.0,37.0,-39.0,-108.0,-106.0,-358.0,-238.0,-119.0,-111.0,41.0,58.0,-44.0,43.0,10.0,56.0,-122.0,53.0,-223.0,-230.0,39.0,52.0,37.0,21.0,1.0,74.0,34.0,62.0,45.0,46.0,4.0,-77.0,6.0,-50.0,65.0,65.0,75.0,66.0,-70.0,16.0,62.0,-20.0,-4.0,-14.0,69.0,73.0,23.0,63.0,-27.0,37.0,69.0,25.0,-5.0,34.0,-228.0,76.0,60.0,57.0,44.0,69.0,44.0,44.0,59.0,73.0,1.0,57.0,35.0,63.0,28.0,-23.0,60.0,54.0,57.0,47.0,60.0,46.0,-25.0,37.0,-47.0,50.0,73.0,32.0,40.0,63.0,-27.0,22.0,60.0,55.0,24.0,37.0,44.0,53.0,30.0,67.0)

rewards <- cbind(Iterations, QLearning)

rewards <- as.matrix(rewards)
rownames(rewards) <- rewards[,'Iterations']
rewards <- subset(rewards, select = -c(Iterations))
rewards <- melt(rewards, id.vars = 'Iterations', variable.names = 'algo')
colnames(rewards) <- c('Iterations', 'algo', 'rewards')

head(rewards)
tail(rewards)

ggplot(rewards, aes(Iterations, rewards)) + 
        geom_line(aes(colour = algo)) + 
        ggtitle("Rewards for hard grid world") 

        ylim(-500, 100)



